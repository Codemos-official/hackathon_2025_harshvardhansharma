{% extends 'base.html' %}

{% block title %}{{ 'Edit User' if edit_user else 'Add User' }} - Gap2Growth{% endblock %}

{% block content %}
<div class="page-header">
    <h1>{{ 'Edit User' if edit_user else 'Add New User' }}</h1>
    <p>{{ 'Update user information and access level.' if edit_user else 'Create a new user account.' }}</p>
</div>

<div class="form-card">
    <form method="POST">
        <div class="form-group">
            <label>Full Name <span>*</span></label>
            <input type="text" class="form-control" name="name" value="{{ edit_user.name if edit_user else '' }}"
                required placeholder="Enter full name">
        </div>

        {% if not edit_user %}
        <div class="form-group">
            <label>Email Address <span>*</span></label>
            <input type="email" class="form-control" name="email" required placeholder="Enter your email">
        </div>
        <div class="form-group">
            <label>Password <span>*</span></label>
            <input type="password" class="form-control" name="password" required
                placeholder="Enter password (min 6 characters)" minlength="6">
            <small class="form-text">This password will be used by the user to login</small>
        </div>
        {% else %}
        <div class="form-group">
            <label>Email Address</label>
            <input type="email" class="form-control" value="{{ edit_user.email }}" disabled>
            <small class="form-text">Email cannot be changed</small>
        </div>
        <div class="form-group">
            <label>New Password</label>
            <input type="password" class="form-control" name="password"
                placeholder="Leave blank to keep current password" minlength="6">
            <small class="form-text">Enter a new password only if you want to change it (min 6 characters)</small>
        </div>
        {% endif %}

        <div class="form-row">
            <div class="form-group">
                <label>Role <span>*</span></label>
                <select class="form-select" name="role" id="roleSelect" required>
                    <option value="student" {{ 'selected' if edit_user and edit_user.role=='student' else '' }}>Student
                    </option>
                    <option value="teacher" {{ 'selected' if edit_user and edit_user.role=='teacher' else '' }}>Teacher
                    </option>
                </select>
            </div>

            <div class="form-group" id="courseGroup">
                <label>Course</label>
                <select class="form-select" name="course" id="courseSelect">
                    <option value="">Select course...</option>
                    <option value="Computer Science" {{ 'selected' if edit_user and edit_user.course=='Computer Science'
                        else '' }}>Computer Science</option>
                    <option value="Information Technology" {{ 'selected' if edit_user and
                        edit_user.course=='Information Technology' else '' }}>Information Technology</option>
                    <option value="Electronics" {{ 'selected' if edit_user and edit_user.course=='Electronics' else ''
                        }}>Electronics</option>
                    <option value="Data Science" {{ 'selected' if edit_user and edit_user.course=='Data Science' else ''
                        }}>Data Science</option>
                </select>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                <i class="bi bi-check"></i> {{ 'Update' if edit_user else 'Create' }} User
            </button>
            <a href="{{ url_for('admin.users_list') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<script>
    document.getElementById('roleSelect').addEventListener('change', function () {
        document.getElementById('courseGroup').style.display = this.value === 'admin' ? 'none' : 'block';
    });
    document.getElementById('roleSelect').dispatchEvent(new Event('change'));
</script>
{% endblock %}